云集是 Web App 的运行环境。基于不同的平台，云集运行环境有不同的实现。云集向符合规范的hosted Web Apps 和 packaged Web Apps 提供多种 API 支持，增强 Web App 的能力。

### W3C Web App Manifest

云集在**一定程度上支持 Manifest**，主要通过以下方式：

* 用户可以手动输入 Web App 的 Manifest 网址来添加 Web App。 （iOS 1.2.7 起）
* 云集会匹配形如 “cloudg:// + manifest URL” 的 URL Scheme，从而引导用户添加 Web App 至云集中。（iOS 1.2.7 起）
* 云集开发者中心为开发者生成的 Web App 的二维码展示页面（比如 http://lydiabox.com/apps/eMhKN ）会自动判断访问者的设备UA，如果为手机端的访客，则自动跳转到以上的 URL Scheme。

但是，由于时间有限，我们暂未支持 Manifest 中的相对路径。也就是说，您的 Manifest 文件中的所有网址都必须是以 http 开头的绝对路径。目前，云集识别以下 Manifest 中的字段：

* name： 			应用名称
* launch_url： 	应用网址
* icons
	* 128			128 x 128 的应用图标
* developer
	* name			应用开发者名称
	* url			应用开发者网站

例：
```
{
	"name": "云集 Web Store",
	"developer": {
		"name": "PortWatcher",
		"url": "http://pwhack.me"
	},
	"icons": {
		"128": "http://cdn.lydiabox.com/xxxx_128.png"
	},
	"launch_url": "http://webstore.lydiabox.com"
}
```

目前云集识别的服务器响应 Manifest 的 MIME Type 有：
* text/plain
* application/json
* application/x-web-app-manifest+json （需要等到 iOS 1.4.0 上线）

### PhoneGap API

云集提供的 API 的签名将最大限度地兼容 PhoneGap API，让您做到不修改或很少修改您的代码，即可让您的 Hybird App 成功运行在云集中。

### 与 PhoneGap API 的区别

虽然云集提供的 API 与 PhoneGap API 函数签名一致，但实现的方式是不同的。PhoneGap 实现其 API 的方式是使用桥接的方式，通过轮询，以 JSON 指令交互的方式来实现 Native 与WebView 的通信。而云集的做法则是直接将 Native 接口直接映射至 WebView 的 JS 上下文中。如果你尝试在控制台打印云集提供的 API，多数情况下你将会得到：
```
function () {
	[native code]
}
```

此外，一些云集提供的 API 与 PhoneGap API 不一致，原因有：
1. W3C 有更加成熟的规范；
2. 出于安全性和隐私保护的考虑，对 PhoneGap API 进行了一定的调整或删减。

## 手势

严格来说，云集只会绑定一个手势，那就是左边缘侧滑，因为 Safari 也用到了这个手势（应该不会有 Web App 不兼容 Safari 的吧），其余手势都会留给 Web App。

默认情况下，呼出侧滑菜单的手势监听区域为整个云集。但是，如果您的 Web App 使用了 HTML5 的触摸事件，您的 Web App 的手势优先级将更高。此时，用户只能通过边缘滑动手势来呼出侧滑菜单。

## 权限

任何与权限有关的调用都会弹出一个提示框来让用户进行授权，若用户同意此次权限申请，API 将继续调用，否则 API 将停止调用。

当用户授权后，授权有效期根据平台特性而不同，云集 iOS 的授权有效期为云集的本次应用周期，也就是说，当云集被系统或用户终结后，下一次启动时所有权限将被重置。

您不应当在用户已经拒绝授权后再次申请权限。